<section class="ev-sm-container ev-view challenge-container">
    <!-- ongoing challenges -->
    <div class="challenge-page-title" id="ongoing-challenges">
        <strong class="text-med-black fs-18">Ongoing Challenges</strong>
    </div>
    <div ng-if="challengeList.noneCurrentChallenge">None</div>
    <div class="row">
        <div class="col s12 m3" ng-repeat="challenge in challengeList.currentList">
            <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                    <div class="card-image ev-card-image">
                        <!-- Lazy load image with placeholder -->
                        <div class="image-placeholder"></div>
                        <img class="bg-img lazy-image" 
                             ng-src="{{challenge.image}}" 
                             onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;"
                             ng-load="challengeList.imageLoaded($event)">
                        <span class="ev-card-title fs-14">
                            <span>
                                <img ng-src="{{challenge.image}}" 
                                     onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;">
                            </span>
                            {{challenge.title}}
                        </span>
                    </div>
                    <div class="card-content">
                        <li ng-repeat="tags in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tags}}</li>
                        <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                        <p><strong class="text-light-black fs-12">Organized by</strong>
                            <br> <strong>{{challenge.creator.team_name}}</strong></p>
                        <p><strong class="text-light-black fs-12">Starts on</strong>
                            <br> <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        <p><strong class="text-light-black fs-12">Ends on</strong>
                            <br> <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                    </div>
                    <div class="btn-card-detail waves-effect waves-dark w-300 fs-14"> <strong>View Details </strong> &nbsp; </div>
                </div>
            </a>
        </div>
    </div>
    <div class="center" ng-if="challengeList.pagination.current.hasMore && !challengeList.pagination.current.loading">
        <button class="btn ev-btn-dark waves-effect waves-dark" ng-click="challengeList.loadMore('current')">
            Load More
        </button>
    </div>
    
    <!-- Loading indicator -->
    <div class="loader-container" ng-show="challengeList.pagination.current.loading">
        <div class="loader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    
    <!-- Upcoming challenges section -->
    <div class="challenge-page-title" id="upcoming-challenges">
        <strong class="text-med-black fs-18">Upcoming Challenges</strong>
    </div>
    <div ng-if="challengeList.noneUpcomingChallenge">None</div>
    <div class="row">
        <div class="col s12 m3" ng-repeat="challenge in challengeList.upcomingList">
            <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                    <div class="card-image ev-card-image">
                        <!-- Lazy load image with placeholder -->
                        <div class="image-placeholder"></div>
                        <img class="bg-img lazy-image" 
                             ng-src="{{challenge.image}}" 
                             onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;"
                             ng-load="challengeList.imageLoaded($event)">
                        <span class="ev-card-title fs-14">
                            <span>
                                <img ng-src="{{challenge.image}}" 
                                     onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;">
                            </span>
                            {{challenge.title}}
                        </span>
                    </div>
                    <div class="card-content">
                        <li ng-repeat="tags in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tags}}</li>
                        <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                        <p><strong class="text-light-black fs-12">Organized by</strong>
                            <br> <strong>{{challenge.creator.team_name}}</strong></p>
                        <p><strong class="text-light-black fs-12">Starts on</strong>
                            <br> <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        <p><strong class="text-light-black fs-12">Ends on</strong>
                            <br> <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                    </div>
                    <div class="btn-card-detail waves-effect waves-dark w-300 fs-14"> <strong>View Details </strong> &nbsp; </div>
                </div>
            </a>
        </div>
    </div>
    <div class="center" ng-if="challengeList.pagination.upcoming.hasMore && !challengeList.pagination.upcoming.loading">
        <button class="btn ev-btn-dark waves-effect waves-dark" ng-click="challengeList.loadMore('upcoming')">
            Load More
        </button>
    </div>
    
    <!-- Loading indicator for upcoming challenges -->
    <div class="loader-container" ng-show="challengeList.pagination.upcoming.loading">
        <div class="loader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    
    <!-- Past challenges section -->
    <div class="challenge-page-title" id="past-challenges">
        <strong class="text-med-black fs-18">Past Challenges</strong>
    </div>
    <div ng-if="challengeList.nonePastChallenge">None</div>
    <div class="row">
        <div class="col s12 m3" ng-repeat="challenge in challengeList.pastList">
            <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                    <div class="card-image ev-card-image">
                        <!-- Lazy load image with placeholder -->
                        <div class="image-placeholder"></div>
                        <img class="bg-img lazy-image" 
                             ng-src="{{challenge.image}}" 
                             onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;"
                             ng-load="challengeList.imageLoaded($event)">
                        <span class="ev-card-title fs-14">
                            <span>
                                <img ng-src="{{challenge.image}}" 
                                     onerror="this.src='/assets/images/default_challenge_image.png'; this.onerror=null;">
                            </span>
                            {{challenge.title}}
                        </span>
                    </div>
                    <div class="card-content">
                        <li ng-repeat="tags in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tags}}</li>
                        <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                        <p><strong class="text-light-black fs-12">Organized by</strong>
                            <br> <strong>{{challenge.creator.team_name}}</strong></p>
                        <p><strong class="text-light-black fs-12">Started on</strong>
                            <br> <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        <p><strong class="text-light-black fs-12">Ended on</strong>
                            <br> <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                    </div>
                    <div class="btn-card-detail waves-effect waves-dark w-300 fs-14"> <strong>View Details </strong> &nbsp; </div>
                </div>
            </a>
        </div>
    </div>
    <div class="center" ng-if="challengeList.pagination.past.hasMore && !challengeList.pagination.past.loading">
        <button class="btn ev-btn-dark waves-effect waves-dark" ng-click="challengeList.loadMore('past')">
            Load More
        </button>
    </div>
    
    <!-- Loading indicator for past challenges -->
    <div class="loader-container" ng-show="challengeList.pagination.past.loading">
        <div class="loader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</section>