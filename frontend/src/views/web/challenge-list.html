<section class="ev-sm-container ev-view challenge-container" ng-controller="ChallengeListCtrl as vm">
    <div class="ChallengeHeader">
        <p class="text-med-black fs-30 no-margin">All Challenges</p>
        
        <!-- Search and Filter Bar -->
        <div class="search-filter-bar">
            <input type="text" ng-model="vm.searchQuery" placeholder="Search Challenges..." class="search-box" />
            <button ng-click="vm.toggleFilterPanel()" class="filter-button">
                <i class="fas fa-filter" style="display: none;"></i>
                {{ vm.isFilterVisible ? 'Hide Filters' : 'Show Filters' }}
            </button>
        </div>
    </div>
        
    <!-- Tabs -->
    <div class="row">
        <div class="col s12">
            <ul class="nav nav-underline" ng-init="tab = 1">
                <li class="nav-item">
                    <a href="" ng-click="tab = 1; vm.resetFilters()" class="nav-link" ng-class="{'active': tab === 1}">
                        <strong class="text-med-black">Ongoing ({{vm.currentList.length}})</strong>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="" ng-click="tab = 2; vm.resetFilters()" class="nav-link" ng-class="{'active': tab === 2}">
                        <strong class="text-med-black">Upcoming ({{vm.upcomingList.length}})</strong>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="" ng-click="tab = 3; vm.resetFilters()" class="nav-link" ng-class="{'active': tab === 3}">
                        <strong class="text-med-black">Past ({{vm.pastList.length}})</strong>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    
    <!-- Filter Panel -->
    <div class="filter-panel" ng-class="{'active': vm.isFilterVisible}">
        <div class="filter-content">
            <button class="close-btn" ng-click="vm.toggleFilterPanel()">&times;</button>
            
            <label>Organization:
                <input type="text" ng-model="vm.filter.organization" placeholder="e.g. EvalAI Team" />
            </label>
            
            <label>Tags:
                <input type="text" ng-model="vm.filter.tags" placeholder="e.g. AI, NLP (comma separated)" />
            </label>
            
            <div class="sort-options">
                <div class="sort-option">
                    <input type="checkbox" id="sortByStartDate" ng-model="vm.filter.sortByStartDate" style="display: none;"/>
                    <label for="sortByStartDate">Sort by Start Date</label>
                </div>
                <div class="sort-option">
                    <input type="checkbox" id="sortByEndDate" ng-model="vm.filter.sortByEndDate" style="display: none;"/>
                    <label for="sortByEndDate">Sort by End Date</label>
                </div>
            </div>
            
            <div class="filter-buttons">
                <button ng-click="vm.resetFilters()" class="reset-button">Reset</button>
                <button ng-click="vm.applyFilter()" class="apply-button">Apply Filters</button>
            </div>
        </div>
    </div>
  
    <!-- Ongoing Challenges -->
    <div ng-show="tab === 1" class="ongoing-challenges" style="display: flex;">
        <div ng-if="vm.noneCurrentChallenge">None</div>
        <div ng-if="vm.hasAppliedFilter && vm.filteredChallenges.length === 0">No challenges match your filter</div>
        <div class="row">
            <div class="col s12 m3" ng-repeat="challenge in (vm.hasAppliedFilter ? vm.filteredChallenges : vm.currentList) | filter:vm.searchQuery">
                <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                    <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                        <div class="card-image ev-card-image">
                            <img class="bg-img" ng-src="{{challenge.image}}">
                            <span class="ev-card-title fs-14">
                                <span><img ng-src="{{challenge.image}}"></span>{{challenge.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <li ng-repeat="tag in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tag}}</li>
                            <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                            <p><strong class="text-light-black fs-12">Organized by</strong><br>
                                <strong>{{challenge.creator.team_name}}</strong></p>
                            <p><strong class="text-light-black fs-12">Starts on</strong><br>
                                <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                            <p><strong class="text-light-black fs-12">Ends on</strong><br>
                                <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        </div>
                        <div class="btn-card-detail waves-effect waves-dark w-300 fs-14">
                            <strong>View Details</strong> &nbsp;
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
  
    <!-- Upcoming Challenges -->
    <div ng-show="tab === 2" class="ongoing-challenges" style="display: flex;">
        <div ng-if="vm.noneUpcomingChallenge">None</div>
        <div class="row">
            <div class="col s12 m3" ng-repeat="challenge in vm.upcomingList | filter:vm.searchQuery">
                <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                    <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                        <div class="card-image ev-card-image">
                            <img class="bg-img" ng-src="{{challenge.image}}">
                            <span class="ev-card-title fs-14">
                                <span><img ng-src="{{challenge.image}}"></span>{{challenge.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <li ng-repeat="tag in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tag}}</li>
                            <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                            <p><strong class="text-light-black fs-12">Organized by</strong><br>
                                <strong>{{challenge.creator.team_name}}</strong></p>
                            <p><strong class="text-light-black fs-12">Starts on</strong><br>
                                <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                            <p><strong class="text-light-black fs-12">Ends on</strong><br>
                                <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        </div>
                        <div class="btn-card-detail waves-effect waves-dark w-300 fs-14">
                            <strong>View Details</strong> &nbsp;
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
  
    <!-- Past Challenges -->
    <div ng-show="tab === 3" class="ongoing-challenges" style="display: flex;">
        <div ng-if="vm.nonePastChallenge">None</div>
        <div class="row">
            <div class="col s12 m3" ng-repeat="challenge in vm.pastList | filter:vm.searchQuery">
                <a class="ev-card-hover" ui-sref="web.challenge-main.challenge-page({challengeId:challenge.id})">
                    <div class="card ev-card-panel ev-challenge-card ev-card-hover">
                        <div class="card-image ev-card-image">
                            <img class="bg-img" ng-src="{{challenge.image}}">
                            <span class="ev-card-title fs-14">
                                <span><img ng-src="{{challenge.image}}"></span>{{challenge.title}}
                            </span>
                        </div>
                        <div class="card-content">
                            <li ng-repeat="tag in challenge.list_tags" class="list-inline-item chip orange white-text tag-size">{{tag}}</li>
                            <li ng-if="challenge.domain" class="list-inline-item chip light-blue white-text">{{challenge.domain}}</li>
                            <p><strong class="text-light-black fs-12">Organized by</strong><br>
                                <strong>{{challenge.creator.team_name}}</strong></p>
                            <p><strong class="text-light-black fs-12">Starts on</strong><br>
                                <strong>{{challenge.start_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                            <p><strong class="text-light-black fs-12">Ends on</strong><br>
                                <strong>{{challenge.end_date | date:'medium'}} {{challenge.time_zone}} ({{challenge.gmt_zone}})</strong></p>
                        </div>
                        <div class="btn-card-detail waves-effect waves-dark w-300 fs-14">
                            <strong>View Details</strong> &nbsp;
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
  
    <!-- Scroll Up Button -->
    <div id="scroll-up" ng-class="vm.scrollUp()">
        <a class="ev-btn-scroll" scroll-to="ongoing-challenges" offset="800">
            <strong><i class="align-right fa fa-chevron-up"></i></strong>
        </a>
    </div>
  
    <!-- Loader -->
    <div class="loader-container" id="sim-loader">
        <div class="text-white center w-300 loader-title">Loading</div>
        <div class="loader">
            <div></div><div></div><div></div><div></div><div></div>
        </div>
    </div>
  </section>
    <!-- Cookie Consent -->
    <div ng-controller="CookieConsentController as cookieConsent">
      <div ng-if="!cookieConsent.cookieConsentResponded" ng-include="'dist/views/web/cookie-consent.html'"></div>
    </div>